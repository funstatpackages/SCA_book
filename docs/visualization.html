<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Visualization | Statistical Computing Using R</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Visualization | Statistical Computing Using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Visualization | Statistical Computing Using R" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Lily Wang" />


<meta name="date" content="2021-01-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exportimport-data.html"/>
<link rel="next" href="r-markdown.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-you-will-learn"><i class="fa fa-check"></i><b>1.1</b> What you will learn</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.2</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i><b>1.3</b> About the Author</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> R Introduction and Preliminaries</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#the-r-environment-and-language"><i class="fa fa-check"></i><b>2.1</b> The R Environment and Language</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#r-and-statistics"><i class="fa fa-check"></i><b>2.2</b> R and Statistics</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>2.3</b> Installing R and RStudio</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#obtaining-r-and-installation"><i class="fa fa-check"></i><b>2.3.1</b> Obtaining R and installation</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#installing-rstudio"><i class="fa fa-check"></i><b>2.3.2</b> Installing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#starting-r"><i class="fa fa-check"></i><b>2.4</b> Starting R</a><ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#description-of-three-panels-in-user-interface"><i class="fa fa-check"></i><b>2.4.1</b> Description of three panels in user interface</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#r-help"><i class="fa fa-check"></i><b>2.4.2</b> R help</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#packages"><i class="fa fa-check"></i><b>2.4.3</b> Packages</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#creating-a-project-and-setting-working-directory"><i class="fa fa-check"></i><b>2.4.4</b> Creating a project and setting working directory</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simple-manipulations-numbers-and-vectors.html"><a href="simple-manipulations-numbers-and-vectors.html"><i class="fa fa-check"></i><b>3</b> Simple Manipulations — Numbers and Vectors</a><ul>
<li class="chapter" data-level="3.1" data-path="simple-manipulations-numbers-and-vectors.html"><a href="simple-manipulations-numbers-and-vectors.html#vectors-and-assignment"><i class="fa fa-check"></i><b>3.1</b> Vectors and Assignment</a></li>
<li class="chapter" data-level="3.2" data-path="simple-manipulations-numbers-and-vectors.html"><a href="simple-manipulations-numbers-and-vectors.html#vector-arithmetic"><i class="fa fa-check"></i><b>3.2</b> Vector Arithmetic</a></li>
<li class="chapter" data-level="3.3" data-path="simple-manipulations-numbers-and-vectors.html"><a href="simple-manipulations-numbers-and-vectors.html#generating-regular-sequences"><i class="fa fa-check"></i><b>3.3</b> Generating Regular Sequences</a></li>
<li class="chapter" data-level="3.4" data-path="simple-manipulations-numbers-and-vectors.html"><a href="simple-manipulations-numbers-and-vectors.html#logical-vectors"><i class="fa fa-check"></i><b>3.4</b> Logical Vectors</a></li>
<li class="chapter" data-level="3.5" data-path="simple-manipulations-numbers-and-vectors.html"><a href="simple-manipulations-numbers-and-vectors.html#missing-values"><i class="fa fa-check"></i><b>3.5</b> Missing values</a></li>
<li class="chapter" data-level="3.6" data-path="simple-manipulations-numbers-and-vectors.html"><a href="simple-manipulations-numbers-and-vectors.html#character-vectors"><i class="fa fa-check"></i><b>3.6</b> Character Vectors</a></li>
<li class="chapter" data-level="3.7" data-path="simple-manipulations-numbers-and-vectors.html"><a href="simple-manipulations-numbers-and-vectors.html#index-vectors"><i class="fa fa-check"></i><b>3.7</b> Index Vectors</a></li>
<li class="chapter" data-level="3.8" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>3.8</b> Exercises:</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-objects.html"><a href="r-objects.html"><i class="fa fa-check"></i><b>4</b> R Objects</a><ul>
<li class="chapter" data-level="4.1" data-path="r-objects.html"><a href="r-objects.html#introduction-of-r-objects"><i class="fa fa-check"></i><b>4.1</b> Introduction of R Objects</a><ul>
<li class="chapter" data-level="4.1.1" data-path="r-objects.html"><a href="r-objects.html#mode-of-objects"><i class="fa fa-check"></i><b>4.1.1</b> Mode of Objects</a></li>
<li class="chapter" data-level="4.1.2" data-path="r-objects.html"><a href="r-objects.html#length-of-objects"><i class="fa fa-check"></i><b>4.1.2</b> Length of Objects</a></li>
<li class="chapter" data-level="4.1.3" data-path="r-objects.html"><a href="r-objects.html#getting-and-setting-attributes"><i class="fa fa-check"></i><b>4.1.3</b> Getting and Setting Attributes</a></li>
<li class="chapter" data-level="4.1.4" data-path="r-objects.html"><a href="r-objects.html#the-class-of-an-object"><i class="fa fa-check"></i><b>4.1.4</b> The class of an object</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="r-objects.html"><a href="r-objects.html#data-structures"><i class="fa fa-check"></i><b>4.2</b> Data Structures</a><ul>
<li class="chapter" data-level="4.2.1" data-path="r-objects.html"><a href="r-objects.html#arrays"><i class="fa fa-check"></i><b>4.2.1</b> Arrays</a></li>
<li class="chapter" data-level="4.2.2" data-path="r-objects.html"><a href="r-objects.html#lists"><i class="fa fa-check"></i><b>4.2.2</b> Lists</a></li>
<li class="chapter" data-level="4.2.3" data-path="r-objects.html"><a href="r-objects.html#data-frames"><i class="fa fa-check"></i><b>4.2.3</b> Data Frames</a></li>
<li class="chapter" data-level="4.2.4" data-path="r-objects.html"><a href="r-objects.html#frequency-tables-from-factors"><i class="fa fa-check"></i><b>4.2.4</b> Frequency Tables From Factors</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exportimport-data.html"><a href="exportimport-data.html"><i class="fa fa-check"></i><b>5</b> Export/Import Data</a><ul>
<li class="chapter" data-level="5.1" data-path="exportimport-data.html"><a href="exportimport-data.html#data-export"><i class="fa fa-check"></i><b>5.1</b> Data Export</a><ul>
<li class="chapter" data-level="5.1.1" data-path="exportimport-data.html"><a href="exportimport-data.html#rdata-files"><i class="fa fa-check"></i><b>5.1.1</b> <code>.RData</code> files</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="exportimport-data.html"><a href="exportimport-data.html#data-import"><i class="fa fa-check"></i><b>5.2</b> Data Import</a><ul>
<li class="chapter" data-level="5.2.1" data-path="exportimport-data.html"><a href="exportimport-data.html#the-load-function"><i class="fa fa-check"></i><b>5.2.1</b> The <code>load()</code> function</a></li>
<li class="chapter" data-level="5.2.2" data-path="exportimport-data.html"><a href="exportimport-data.html#the-read.table-function"><i class="fa fa-check"></i><b>5.2.2</b> The <code>read.table()</code> function</a></li>
<li class="chapter" data-level="5.2.3" data-path="exportimport-data.html"><a href="exportimport-data.html#the-scan-function"><i class="fa fa-check"></i><b>5.2.3</b> The <code>scan()</code> function</a></li>
<li class="chapter" data-level="5.2.4" data-path="exportimport-data.html"><a href="exportimport-data.html#the-read.csv-function"><i class="fa fa-check"></i><b>5.2.4</b> The <code>read.csv()</code> function</a></li>
<li class="chapter" data-level="5.2.5" data-path="exportimport-data.html"><a href="exportimport-data.html#import-an-excel-file-into-r"><i class="fa fa-check"></i><b>5.2.5</b> Import an Excel file into R</a></li>
<li class="chapter" data-level="5.2.6" data-path="exportimport-data.html"><a href="exportimport-data.html#accessing-built-in-datasets"><i class="fa fa-check"></i><b>5.2.6</b> Accessing built-in datasets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>6</b> Visualization</a><ul>
<li class="chapter" data-level="6.1" data-path="visualization.html"><a href="visualization.html#bar-chart"><i class="fa fa-check"></i><b>6.1</b> Bar Chart</a></li>
<li class="chapter" data-level="6.2" data-path="visualization.html"><a href="visualization.html#pie-charts"><i class="fa fa-check"></i><b>6.2</b> Pie charts</a></li>
<li class="chapter" data-level="6.3" data-path="visualization.html"><a href="visualization.html#stem-and-leaf-charts"><i class="fa fa-check"></i><b>6.3</b> Stem-and-leaf Charts</a></li>
<li class="chapter" data-level="6.4" data-path="visualization.html"><a href="visualization.html#histograms"><i class="fa fa-check"></i><b>6.4</b> Histograms</a></li>
<li class="chapter" data-level="6.5" data-path="visualization.html"><a href="visualization.html#boxplot"><i class="fa fa-check"></i><b>6.5</b> Boxplot</a><ul>
<li class="chapter" data-level="6.5.1" data-path="visualization.html"><a href="visualization.html#boxplot-one-sample"><i class="fa fa-check"></i><b>6.5.1</b> Boxplot: one sample</a></li>
<li class="chapter" data-level="6.5.2" data-path="visualization.html"><a href="visualization.html#plotting-several-samples"><i class="fa fa-check"></i><b>6.5.2</b> Plotting several samples</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="visualization.html"><a href="visualization.html#scatterplot"><i class="fa fa-check"></i><b>6.6</b> Scatterplot</a><ul>
<li class="chapter" data-level="6.6.1" data-path="visualization.html"><a href="visualization.html#basic-command"><i class="fa fa-check"></i><b>6.6.1</b> Basic command</a></li>
<li class="chapter" data-level="6.6.2" data-path="visualization.html"><a href="visualization.html#more-useful-commands"><i class="fa fa-check"></i><b>6.6.2</b> More useful commands</a></li>
<li class="chapter" data-level="6.6.3" data-path="visualization.html"><a href="visualization.html#an-example-with-multiple-symbols"><i class="fa fa-check"></i><b>6.6.3</b> An example with multiple symbols</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="visualization.html"><a href="visualization.html#line-plots-and-time-series-plots"><i class="fa fa-check"></i><b>6.7</b> Line plots and Time series plots</a><ul>
<li class="chapter" data-level="6.7.1" data-path="visualization.html"><a href="visualization.html#plot-types"><i class="fa fa-check"></i><b>6.7.1</b> Plot types</a></li>
<li class="chapter" data-level="6.7.2" data-path="visualization.html"><a href="visualization.html#time-series"><i class="fa fa-check"></i><b>6.7.2</b> Time Series</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="visualization.html"><a href="visualization.html#visualization-using-ggplot2"><i class="fa fa-check"></i><b>6.8</b> Visualization using <code>ggplot2</code></a><ul>
<li class="chapter" data-level="6.8.1" data-path="visualization.html"><a href="visualization.html#scatter-plots"><i class="fa fa-check"></i><b>6.8.1</b> Scatter plots</a></li>
<li class="chapter" data-level="6.8.2" data-path="visualization.html"><a href="visualization.html#creating-maps-with-ggplot2"><i class="fa fa-check"></i><b>6.8.2</b> Creating maps with <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>6.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>7</b> R Markdown</a><ul>
<li class="chapter" data-level="7.1" data-path="r-markdown.html"><a href="r-markdown.html#getting-started-with-r-markdown"><i class="fa fa-check"></i><b>7.1</b> Getting Started with R Markdown</a></li>
<li class="chapter" data-level="7.2" data-path="r-markdown.html"><a href="r-markdown.html#formatting-your-document"><i class="fa fa-check"></i><b>7.2</b> Formatting Your Document</a></li>
<li class="chapter" data-level="7.3" data-path="r-markdown.html"><a href="r-markdown.html#text-formatting"><i class="fa fa-check"></i><b>7.3</b> Text Formatting</a></li>
<li class="chapter" data-level="7.4" data-path="r-markdown.html"><a href="r-markdown.html#greek-alphabet"><i class="fa fa-check"></i><b>7.4</b> Greek Alphabet</a></li>
<li class="chapter" data-level="7.5" data-path="r-markdown.html"><a href="r-markdown.html#r-code-chunks-and-inline-r-code"><i class="fa fa-check"></i><b>7.5</b> R code chunks and inline R code</a></li>
<li class="chapter" data-level="7.6" data-path="r-markdown.html"><a href="r-markdown.html#including-plots-and-adding-captions"><i class="fa fa-check"></i><b>7.6</b> Including Plots and Adding Captions</a></li>
<li class="chapter" data-level="7.7" data-path="r-markdown.html"><a href="r-markdown.html#modifying-figures"><i class="fa fa-check"></i><b>7.7</b> Modifying Figures</a></li>
<li class="chapter" data-level="7.8" data-path="r-markdown.html"><a href="r-markdown.html#displaying-data-with-kable"><i class="fa fa-check"></i><b>7.8</b> Displaying Data with kable</a></li>
<li class="chapter" data-level="7.9" data-path="r-markdown.html"><a href="r-markdown.html#compiling-r-markdown-documents"><i class="fa fa-check"></i><b>7.9</b> Compiling R Markdown Documents</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-wrangling-with-dplyr-and-tidyr.html"><a href="data-wrangling-with-dplyr-and-tidyr.html"><i class="fa fa-check"></i><b>8</b> Data Wrangling with <code>dplyr</code> and <code>tidyr</code></a><ul>
<li class="chapter" data-level="8.1" data-path="data-wrangling-with-dplyr-and-tidyr.html"><a href="data-wrangling-with-dplyr-and-tidyr.html#learning-dplyr"><i class="fa fa-check"></i><b>8.1</b> Learning <code>dplyr</code></a></li>
<li class="chapter" data-level="8.2" data-path="data-wrangling-with-dplyr-and-tidyr.html"><a href="data-wrangling-with-dplyr-and-tidyr.html#selecting-columns-and-filtering-rows"><i class="fa fa-check"></i><b>8.2</b> Selecting columns and filtering rows</a></li>
<li class="chapter" data-level="8.3" data-path="data-wrangling-with-dplyr-and-tidyr.html"><a href="data-wrangling-with-dplyr-and-tidyr.html#pipes"><i class="fa fa-check"></i><b>8.3</b> Pipes</a></li>
<li class="chapter" data-level="8.4" data-path="data-wrangling-with-dplyr-and-tidyr.html"><a href="data-wrangling-with-dplyr-and-tidyr.html#select-and-order-top-n-entries-by-group-if-grouped-data."><i class="fa fa-check"></i><b>8.4</b> Select and order top n entries (by group if grouped data).</a></li>
<li class="chapter" data-level="8.5" data-path="data-wrangling-with-dplyr-and-tidyr.html"><a href="data-wrangling-with-dplyr-and-tidyr.html#mutate"><i class="fa fa-check"></i><b>8.5</b> Mutate</a></li>
<li class="chapter" data-level="8.6" data-path="data-wrangling-with-dplyr-and-tidyr.html"><a href="data-wrangling-with-dplyr-and-tidyr.html#split-apply-combine-data-analysis-and-the-summarize-function"><i class="fa fa-check"></i><b>8.6</b> Split-apply-combine data analysis and the <code>summarize()</code> function</a></li>
<li class="chapter" data-level="8.7" data-path="data-wrangling-with-dplyr-and-tidyr.html"><a href="data-wrangling-with-dplyr-and-tidyr.html#joins-with-dplyr"><i class="fa fa-check"></i><b>8.7</b> Joins with <code>dplyr</code></a></li>
<li class="chapter" data-level="8.8" data-path="data-wrangling-with-dplyr-and-tidyr.html"><a href="data-wrangling-with-dplyr-and-tidyr.html#reshaping-data---change-the-layout-of-a-data-set"><i class="fa fa-check"></i><b>8.8</b> Reshaping Data - Change the layout of a data set</a><ul>
<li class="chapter" data-level="8.8.1" data-path="data-wrangling-with-dplyr-and-tidyr.html"><a href="data-wrangling-with-dplyr-and-tidyr.html#from-wide-to-long"><i class="fa fa-check"></i><b>8.8.1</b> From wide to long</a></li>
<li class="chapter" data-level="8.8.2" data-path="data-wrangling-with-dplyr-and-tidyr.html"><a href="data-wrangling-with-dplyr-and-tidyr.html#from-long-to-wide"><i class="fa fa-check"></i><b>8.8.2</b> From long to wide</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>8.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="advanced-programming-in-r.html"><a href="advanced-programming-in-r.html"><i class="fa fa-check"></i><b>9</b> Advanced Programming in R</a><ul>
<li class="chapter" data-level="9.1" data-path="advanced-programming-in-r.html"><a href="advanced-programming-in-r.html#grouped-expressions"><i class="fa fa-check"></i><b>9.1</b> Grouped expressions</a></li>
<li class="chapter" data-level="9.2" data-path="advanced-programming-in-r.html"><a href="advanced-programming-in-r.html#conditional-execution-if-statements"><i class="fa fa-check"></i><b>9.2</b> Conditional execution: <code>if</code> statements</a><ul>
<li class="chapter" data-level="9.2.1" data-path="advanced-programming-in-r.html"><a href="advanced-programming-in-r.html#iterations"><i class="fa fa-check"></i><b>9.2.1</b> Iterations</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="advanced-programming-in-r.html"><a href="advanced-programming-in-r.html#writing-functions"><i class="fa fa-check"></i><b>9.3</b> Writing Functions</a><ul>
<li class="chapter" data-level="9.3.1" data-path="advanced-programming-in-r.html"><a href="advanced-programming-in-r.html#simple-examples"><i class="fa fa-check"></i><b>9.3.1</b> Simple examples</a></li>
<li class="chapter" data-level="9.3.2" data-path="advanced-programming-in-r.html"><a href="advanced-programming-in-r.html#named-arguments-and-defaults"><i class="fa fa-check"></i><b>9.3.2</b> Named arguments and defaults</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="advanced-programming-in-r.html"><a href="advanced-programming-in-r.html#lexical-vs.-dynamic-scoping"><i class="fa fa-check"></i><b>9.4</b> Lexical vs. Dynamic Scoping</a><ul>
<li class="chapter" data-level="9.4.1" data-path="advanced-programming-in-r.html"><a href="advanced-programming-in-r.html#scoping-rules"><i class="fa fa-check"></i><b>9.4.1</b> Scoping rules</a></li>
<li class="chapter" data-level="9.4.2" data-path="advanced-programming-in-r.html"><a href="advanced-programming-in-r.html#an-environment"><i class="fa fa-check"></i><b>9.4.2</b> An Environment</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>9.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="simulations.html"><a href="simulations.html"><i class="fa fa-check"></i><b>10</b> Simulations</a><ul>
<li class="chapter" data-level="10.1" data-path="simulations.html"><a href="simulations.html#probability-distributions-and-generating-random-variables"><i class="fa fa-check"></i><b>10.1</b> Probability Distributions and Generating Random Variables</a></li>
<li class="chapter" data-level="10.2" data-path="simulations.html"><a href="simulations.html#more-examples"><i class="fa fa-check"></i><b>10.2</b> More Examples</a></li>
<li class="chapter" data-level="10.3" data-path="simulations.html"><a href="simulations.html#setting-random-number-seed"><i class="fa fa-check"></i><b>10.3</b> Setting Random Number Seed</a></li>
<li class="chapter" data-level="10.4" data-path="simulations.html"><a href="simulations.html#example-normal-approximation-to-the-binomials"><i class="fa fa-check"></i><b>10.4</b> Example: Normal Approximation to the Binomials</a></li>
<li class="chapter" data-level="10.5" data-path="simulations.html"><a href="simulations.html#random-sampling-using-sample"><i class="fa fa-check"></i><b>10.5</b> Random Sampling using <code>sample</code></a></li>
<li class="chapter" data-level="10.6" data-path="simulations.html"><a href="simulations.html#a-simulation-example"><i class="fa fa-check"></i><b>10.6</b> A Simulation Example</a></li>
<li class="chapter" data-level="10.7" data-path="simulations.html"><a href="simulations.html#basics-of-simulation"><i class="fa fa-check"></i><b>10.7</b> Basics of Simulation</a><ul>
<li class="chapter" data-level="10.7.1" data-path="simulations.html"><a href="simulations.html#repetition"><i class="fa fa-check"></i><b>10.7.1</b> Repetition</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>10.8</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Computing Using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualization" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Visualization</h1>
<div id="bar-chart" class="section level2">
<h2><span class="header-section-number">6.1</span> Bar Chart</h2>
<p>A bar chart draws a bar with a height proportional to the count in the table. The height could be given by the frequency or the proportion. The graph will look the same, but the scales may be different.</p>
<p>Suppose a group of 25 people are surveyed as to their beer-drinking preference. The categories were (1) Domestic can, (2) Domestic bottle, (3) Microbrew, and (4) import. The raw data is</p>
<pre><code>3 4 1 1 3 4 3 3 1 3 2 1 2 1 2 3 2 3 1 1 1 1 4 3 1</code></pre>
<p>Let’s make a barplot of both frequencies and proportions. First, we use the <code>scan</code> function to read in the data:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="visualization.html#cb165-1"></a>beer &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, </span>
<span id="cb165-2"><a href="visualization.html#cb165-2"></a>    <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span></code></pre></div>
<p>then we plot a bar chart:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="visualization.html#cb166-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb166-2"><a href="visualization.html#cb166-2"></a><span class="co"># This isn&#39;t correct</span></span>
<span id="cb166-3"><a href="visualization.html#cb166-3"></a><span class="kw">barplot</span>(beer) </span>
<span id="cb166-4"><a href="visualization.html#cb166-4"></a><span class="co"># Yes, call with summarized data</span></span>
<span id="cb166-5"><a href="visualization.html#cb166-5"></a><span class="kw">barplot</span>(<span class="kw">table</span>(beer))     </span>
<span id="cb166-6"><a href="visualization.html#cb166-6"></a><span class="co"># Divide by n for proportion</span></span>
<span id="cb166-7"><a href="visualization.html#cb166-7"></a><span class="kw">barplot</span>(<span class="kw">table</span>(beer) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(beer)) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:barplots"></span>
<img src="SCA_book_files/figure-html/barplots-1.png" alt="Bar chart examples" width="672" />
<p class="caption">
Figure 6.1: Bar chart examples
</p>
</div>
<ol style="list-style-type: decimal">
<li><p>We did 3 barplots in Figure <a href="visualization.html#fig:barplots">6.1</a>. The first to show that we don’t use <code>barplot</code> with the raw data.</p></li>
<li><p>The second shows the use of the table command to create summarized data, and the result of this is sent to barplot creating the barplot of frequencies shown.</p></li>
<li><p>Finally, the command</p></li>
</ol>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="visualization.html#cb167-1"></a><span class="kw">table</span>(beer)<span class="op">/</span><span class="kw">length</span>(beer)</span></code></pre></div>
<pre><code>## beer
##    1    2    3    4 
## 0.40 0.16 0.32 0.12</code></pre>
<p>produces the proportions first. We divide it by the number of data points, which is 25 or <code>length(beer)</code>. The result is then handed off to barplot to make a graph. Notice it has the same shape as the previous one, but the height axis is now between 0 and 1 as it measures the proportion and not the frequency.</p>
<ol start="4" style="list-style-type: decimal">
<li>This is ugly, you can change the color by specifying <code>col</code>; see Figure <a href="visualization.html#fig:barplotc">6.2</a>.</li>
</ol>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="visualization.html#cb169-1"></a><span class="kw">barplot</span>(<span class="kw">table</span>(beer) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(beer),</span>
<span id="cb169-2"><a href="visualization.html#cb169-2"></a>        <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;mistyrose&quot;</span>, <span class="st">&quot;lightcyan&quot;</span>, <span class="st">&quot;cornsilk&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:barplotc"></span>
<img src="SCA_book_files/figure-html/barplotc-1.png" alt="A colored bar chart example" width="50%" />
<p class="caption">
Figure 6.2: A colored bar chart example
</p>
</div>
</div>
<div id="pie-charts" class="section level2">
<h2><span class="header-section-number">6.2</span> Pie charts</h2>
<p>The same data can be studied with pie charts using the <code>pie</code> function. Here are some simple examples illustrating the usage (similar to <code>barplot()</code>, but with some added features. See Figure <a href="visualization.html#fig:pies">6.3</a>.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="visualization.html#cb170-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb170-2"><a href="visualization.html#cb170-2"></a></span>
<span id="cb170-3"><a href="visualization.html#cb170-3"></a><span class="co"># Store the table result</span></span>
<span id="cb170-4"><a href="visualization.html#cb170-4"></a>beer.counts &lt;-<span class="st"> </span><span class="kw">table</span>(beer) </span>
<span id="cb170-5"><a href="visualization.html#cb170-5"></a><span class="co"># First pie -- kind of dull</span></span>
<span id="cb170-6"><a href="visualization.html#cb170-6"></a><span class="kw">pie</span>(beer.counts)     </span>
<span id="cb170-7"><a href="visualization.html#cb170-7"></a><span class="co"># Give names</span></span>
<span id="cb170-8"><a href="visualization.html#cb170-8"></a><span class="kw">names</span>(beer.counts) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;domestic</span><span class="ch">\n</span><span class="st"> can&quot;</span>, <span class="st">&quot;Domestic</span><span class="ch">\n</span><span class="st"> bottle&quot;</span>,</span>
<span id="cb170-9"><a href="visualization.html#cb170-9"></a>                       <span class="st">&quot;Microbrew&quot;</span>, <span class="st">&quot;Import&quot;</span>) </span>
<span id="cb170-10"><a href="visualization.html#cb170-10"></a><span class="co"># Prints out names</span></span>
<span id="cb170-11"><a href="visualization.html#cb170-11"></a><span class="kw">pie</span>(beer.counts)          </span>
<span id="cb170-12"><a href="visualization.html#cb170-12"></a><span class="co"># Now with colors</span></span>
<span id="cb170-13"><a href="visualization.html#cb170-13"></a><span class="kw">pie</span>(beer.counts, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;purple&quot;</span>, <span class="st">&quot;green2&quot;</span>, <span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;white&quot;</span>)) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pies"></span>
<img src="SCA_book_files/figure-html/pies-1.png" alt="Pie chart plotting examples." width="672" />
<p class="caption">
Figure 6.3: Pie chart plotting examples.
</p>
</div>
<p>The first one was kind of boring, so we added names. This is done with the <code>names()</code>, which allows us to specify names to the categories. The resulting piechart shows how the names are used. Finally, we added color to the piechart. This is done by setting the piechart attribute col. We set this equal to a vector of color names that was the same length as our <code>beer.counts</code>. The help command (<code>?pie</code>) gives some examples for automatically getting different colors, notably using rainbow and gray.</p>
<p>Notice we used additional arguments to the function pie. The syntax for these is name=value. The ability to pass in named values to a function makes it easy to have fewer functions as each one can have more functionality.</p>
</div>
<div id="stem-and-leaf-charts" class="section level2">
<h2><span class="header-section-number">6.3</span> Stem-and-leaf Charts</h2>
<p>If the data set is relatively small, the stem-and-leaf diagram is handy for seeing the shape of the distribution and the values. The number on the left of the bar is the stem, the number on the right the digit. You put them together to find the observation.</p>
<p>Suppose you have the box score of a basketball game and find the following points per game for players on both teams:</p>
<pre><code>2 3 16 23 14 12 4 13 2 0 0 0 6 28 31 14 4 8 2 5</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="visualization.html#cb172-1"></a>scores &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">16</span>, <span class="dv">23</span>, <span class="dv">14</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">13</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">28</span>, <span class="dv">31</span>, </span>
<span id="cb172-2"><a href="visualization.html#cb172-2"></a>    <span class="dv">14</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb172-3"><a href="visualization.html#cb172-3"></a><span class="co"># What exactly is the name?</span></span>
<span id="cb172-4"><a href="visualization.html#cb172-4"></a><span class="kw">apropos</span>(<span class="st">&quot;stem&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;R_system_version&quot; &quot;stem&quot;             &quot;system&quot;          
## [4] &quot;system.file&quot;      &quot;system.time&quot;      &quot;system2&quot;</code></pre>
<p>To create a stem and leaf chart is simple:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="visualization.html#cb174-1"></a><span class="kw">stem</span>(scores)</span></code></pre></div>
<pre><code>## 
##   The decimal point is 1 digit(s) to the right of the |
## 
##   0 | 000222344568
##   1 | 23446
##   2 | 38
##   3 | 1</code></pre>
<p>Notice we use <code>apropos()</code> to help find the name for the function. It is <code>stem()</code> and not <code>stemleaf()</code>. The <code>apropos()</code> command is convenient when you think you know the function’s name but aren’t sure.</p>
<p>Suppose we wanted to break up the categories into groups of 5. We can do so by setting the “scale”</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="visualization.html#cb176-1"></a><span class="kw">stem</span>(scores, <span class="dt">scale =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
##   The decimal point is 1 digit(s) to the right of the |
## 
##   0 | 000222344
##   0 | 568
##   1 | 2344
##   1 | 6
##   2 | 3
##   2 | 8
##   3 | 1</code></pre>
</div>
<div id="histograms" class="section level2">
<h2><span class="header-section-number">6.4</span> Histograms</h2>
<p>If there is too much data, or your audience doesn’t know how to read the stem-and-leaf, you might try other summaries. The most common is similar to the bar plot and is a histogram. The histogram defines a sequence of breaks and then counts the number of observations in the bins formed by the breaks. (This is identical to the features of the <code>cut()</code> function.) It plots these with a bar similar to the bar chart, but the bars are touching. The height can be the frequencies or proportions.</p>
<p>Let’s begin with a simple example. Suppose the top 25 ranked movies made the following gross receipts for a week 4</p>
<pre><code>29.6 28.2 19.6 13.7 13.0 7.8 3.4 2.0 1.9 1.0 0.7 0.4 0.4 0.3
0.3 0.3 0.3 0.3 0.2 0.2 0.2 0.1 0.1 0.1 0.1 0.1</code></pre>
<p>We now make some histograms:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="visualization.html#cb179-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">29.6</span>, <span class="fl">28.2</span>, <span class="fl">19.6</span>, <span class="fl">13.7</span>, <span class="fl">13.0</span>, <span class="fl">7.8</span>, <span class="fl">3.4</span>, <span class="fl">2.0</span>, <span class="fl">1.9</span>, <span class="fl">1.0</span>, </span>
<span id="cb179-2"><a href="visualization.html#cb179-2"></a>       <span class="fl">0.7</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, </span>
<span id="cb179-3"><a href="visualization.html#cb179-3"></a>       <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>)</span>
<span id="cb179-4"><a href="visualization.html#cb179-4"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb179-5"><a href="visualization.html#cb179-5"></a><span class="kw">hist</span>(x) <span class="co"># frequencies</span></span>
<span id="cb179-6"><a href="visualization.html#cb179-6"></a><span class="kw">hist</span>(x, <span class="dt">probability =</span> <span class="ot">TRUE</span>) <span class="co"># proportions (or probabilities)</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:hist"></span>
<img src="SCA_book_files/figure-html/hist-1.png" alt="Examples of histogram." width="75%" />
<p class="caption">
Figure 6.4: Examples of histogram.
</p>
</div>
<p>Two graphs are shown in Figure <a href="visualization.html#fig:hist">6.4</a>. The first is the default graph which makes a histogram of frequencies (total counts). The second does a histogram of proportions which makes the total area add to 1. This is preferred as it relates better to the concept of a probability density. Note the only difference is the scale on the y axis.</p>
<p>The basic histogram has a predefined set of break points for the bins. If you want, you can specify the number of breaks or your own break points; see Figure <a href="visualization.html#fig:hist2">6.5</a>.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="visualization.html#cb180-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb180-2"><a href="visualization.html#cb180-2"></a><span class="co"># Specify 10 breaks, or just hist(x, 10)</span></span>
<span id="cb180-3"><a href="visualization.html#cb180-3"></a><span class="kw">hist</span>(x, <span class="dt">breaks =</span> <span class="dv">10</span>)</span>
<span id="cb180-4"><a href="visualization.html#cb180-4"></a><span class="co"># Specify break points</span></span>
<span id="cb180-5"><a href="visualization.html#cb180-5"></a><span class="kw">hist</span>(x, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="kw">max</span>(x)))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:hist2"></span>
<img src="SCA_book_files/figure-html/hist2-1.png" alt="More examples of histogram." width="75%" />
<p class="caption">
Figure 6.5: More examples of histogram.
</p>
</div>
</div>
<div id="boxplot" class="section level2">
<h2><span class="header-section-number">6.5</span> Boxplot</h2>
<p>The boxplot is used to summarize data succinctly, quickly displaying if the data is symmetric or has suspected outliers. It is based on the 5-number summary.</p>
<div id="boxplot-one-sample" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Boxplot: one sample</h3>
<p>The basic function is <code>boxplot()</code></p>
<p>Example: Suppose we have 11 observations:</p>
<pre><code>7 9.5 10 11 10 10 8 11 18 13 11.5</code></pre>
<p>Figure <a href="visualization.html#fig:boxplot">6.6</a> shows a basic boxplot.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="visualization.html#cb182-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>, <span class="fl">9.5</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">18</span>, <span class="dv">13</span>, <span class="fl">11.5</span>)</span>
<span id="cb182-2"><a href="visualization.html#cb182-2"></a><span class="kw">boxplot</span>(x, <span class="dt">horizontal =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:boxplot"></span>
<img src="SCA_book_files/figure-html/boxplot-1.png" alt="An example of boxplot." width="75%" />
<p class="caption">
Figure 6.6: An example of boxplot.
</p>
</div>
<p>We can add axis labels, a main title and color the box using simple commands; see Figure <a href="visualization.html#fig:boxplot2">6.7</a>.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="visualization.html#cb183-1"></a><span class="kw">boxplot</span>(x, <span class="dt">xlab =</span> <span class="st">&quot;Single sample&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Value axis&quot;</span>, </span>
<span id="cb183-2"><a href="visualization.html#cb183-2"></a>        <span class="dt">main =</span> <span class="st">&quot;Simple Box plot&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:boxplot2"></span>
<img src="SCA_book_files/figure-html/boxplot2-1.png" alt="An example of boxplot with title and colored box." width="75%" />
<p class="caption">
Figure 6.7: An example of boxplot with title and colored box.
</p>
</div>
</div>
<div id="plotting-several-samples" class="section level3">
<h3><span class="header-section-number">6.5.2</span> Plotting several samples</h3>
<p>So we can see how to represent a single sample but often we wish to compare samples. For example, we may have raised broods of flies on various sugars. We measure the size of the individual flies and record the diet for each. Our data file would consist of two columns; one for growth and one for sugar. For example,</p>
<pre><code>growth	sugar
75	C
72	C
73	C
61	F
67	F
64	F
62	S
63	S</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="visualization.html#cb185-1"></a>growth &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">75</span>, <span class="dv">72</span>, <span class="dv">73</span>, <span class="dv">61</span>, <span class="dv">67</span>, <span class="dv">64</span>, <span class="dv">62</span>, <span class="dv">63</span>)</span>
<span id="cb185-2"><a href="visualization.html#cb185-2"></a>sugar &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;S&quot;</span>)</span>
<span id="cb185-3"><a href="visualization.html#cb185-3"></a>fly &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">growth =</span> growth, <span class="dt">sugar =</span> sugar)</span></code></pre></div>
<p>To plot these we use the boxplot command with slightly different syntax e.g. <code>boxplot(y ~ x)</code>. This model syntax is used widely in R for setting-up regression analyses for example.</p>
<p>To create a summary boxplot in Figure <a href="visualization.html#fig:sideboxplot">6.8</a> we type something like:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="visualization.html#cb186-1"></a><span class="kw">boxplot</span>(growth <span class="op">~</span><span class="st"> </span>sugar, <span class="dt">data =</span> fly, <span class="dt">xlab =</span> <span class="st">&quot;Sugar type&quot;</span>, </span>
<span id="cb186-2"><a href="visualization.html#cb186-2"></a>        <span class="dt">ylab =</span> <span class="st">&quot;Growth&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;bisque&quot;</span>, <span class="dt">range =</span> <span class="dv">0</span>)</span>
<span id="cb186-3"><a href="visualization.html#cb186-3"></a><span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Growth against sugar type&quot;</span>, <span class="dt">font.main =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:sideboxplot"></span>
<img src="SCA_book_files/figure-html/sideboxplot-1.png" alt="An example of side by side boxplot." width="75%" />
<p class="caption">
Figure 6.8: An example of side by side boxplot.
</p>
</div>
<p>Now we can see that the different sugar treatments appear to produce differing growth in our subjects.</p>
</div>
</div>
<div id="scatterplot" class="section level2">
<h2><span class="header-section-number">6.6</span> Scatterplot</h2>
<p>Often we wish to investigate one numerical variable against another. For example the height of a father compared to their sons height.</p>
<div id="basic-command" class="section level3">
<h3><span class="header-section-number">6.6.1</span> Basic command</h3>
<p>As usual with R there are many additional parameters that you can add to customize your plots. The basic command is:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="visualization.html#cb187-1"></a><span class="kw">plot</span>(x, y)</span></code></pre></div>
<p>where <code>x</code> is the name of your x-variable and <code>y</code> is the name of your y-variable. This is fine if you have two variables but if they are part of a bigger data set, then you can use command</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="visualization.html#cb188-1"></a><span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> your.data)</span></code></pre></div>
<p>Note the use of the model syntax. This model syntax is used widely in R for setting-up ANOVA and regression analyses for example (see also it’s use in the boxplot).</p>
<p>R comes with a number of data sets built-in; these are used in the examples and can be useful to ‘play with’. For example, the data set cars contains two variables speed and dist. To see a basic scatter plot like Figure <a href="visualization.html#fig:scatter1">6.9</a> try the following:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="visualization.html#cb189-1"></a><span class="kw">plot</span>(dist <span class="op">~</span><span class="st"> </span>speed, <span class="dt">data =</span> cars)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:scatter1"></span>
<img src="SCA_book_files/figure-html/scatter1-1.png" alt="A simple example of scatterplot." width="75%" />
<p class="caption">
Figure 6.9: A simple example of scatterplot.
</p>
</div>
<p>This basic scatterplot takes the axes labels from the variables and uses open circles as the plotting symbol.</p>
<p><strong>Additional commands with regression fit</strong></p>
<p>As usual with R we have a wealth of additional commands at our disposal to beef up the display. A useful additional command is to add a line of best-fit. This is a command that adds to the current plot (like the <code>title()</code> command). For the above example we’d type:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="visualization.html#cb190-1"></a><span class="kw">plot</span>(dist <span class="op">~</span><span class="st"> </span>speed, <span class="dt">data =</span> cars)</span>
<span id="cb190-2"><a href="visualization.html#cb190-2"></a><span class="kw">abline</span>(<span class="kw">lm</span>(dist <span class="op">~</span><span class="st"> </span>speed, <span class="dt">data =</span> cars))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:scatter2"></span>
<img src="SCA_book_files/figure-html/scatter2-1.png" alt="A scatterplot with fitted regression line." width="75%" />
<p class="caption">
Figure 6.10: A scatterplot with fitted regression line.
</p>
</div>
<p>The basic command uses <code>abline(a, b)</code>, where <code>a=slope</code> and <code>b=intercept</code>. Here we use a linear model command to calculate the best-fit equation for us (try typing the <code>lm()</code> command separately, you get the intercept and slope) as shown in Figure <a href="visualization.html#fig:scatter2">6.10</a>.</p>
<p>If we combine this with a couple of extra lines we can produce a better looking plot in Figure <a href="visualization.html#fig:scatter3">6.11</a>:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="visualization.html#cb191-1"></a><span class="kw">plot</span>(dist <span class="op">~</span><span class="st"> </span>speed, <span class="dt">data =</span> cars, <span class="dt">xlab =</span> <span class="st">&quot;Speed&quot;</span>,</span>
<span id="cb191-2"><a href="visualization.html#cb191-2"></a>     <span class="dt">ylab =</span> <span class="st">&quot;Distance&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb191-3"><a href="visualization.html#cb191-3"></a><span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Scatter plot with best-fit line&quot;</span>, <span class="dt">font.main=</span> <span class="dv">4</span>)</span>
<span id="cb191-4"><a href="visualization.html#cb191-4"></a><span class="kw">abline</span>(<span class="kw">lm</span>(dist <span class="op">~</span><span class="st"> </span>speed, <span class="dt">data =</span> cars), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:scatter3"></span>
<img src="SCA_book_files/figure-html/scatter3-1.png" alt="A better-looking scatterplot with fitted regression line." width="75%" />
<p class="caption">
Figure 6.11: A better-looking scatterplot with fitted regression line.
</p>
</div>
<p>This illustrates several of the additional commands. We have set the axis labels and the color of the plotting symbols. Next we added a main title and set the font to bold italic (try other values). Finally we set the best-fit line and made it red.</p>
</div>
<div id="more-useful-commands" class="section level3">
<h3><span class="header-section-number">6.6.2</span> More useful commands</h3>
<p>We can alter the plotting symbol using the command pch=n, where n is a simple number. We can also alter the range of the x and y axes using <code>xlim=c(lower, upper)</code> and <code>ylim=c(lower, upper)</code>. The size of the plotted points is manipulated using the <code>cex=n</code> command, where `n= the magnification’ factor. Here are some commands that illustrate these parameters:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="visualization.html#cb192-1"></a><span class="kw">plot</span>(dist <span class="op">~</span><span class="st"> </span>speed, <span class="dt">data =</span> cars, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">25</span>), </span>
<span id="cb192-2"><a href="visualization.html#cb192-2"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>, <span class="dv">120</span>), <span class="dt">cex =</span> <span class="dv">2</span>)</span>
<span id="cb192-3"><a href="visualization.html#cb192-3"></a><span class="kw">abline</span>(<span class="kw">lm</span>(dist <span class="op">~</span><span class="st"> </span>speed, <span class="dt">data =</span> cars))</span>
<span id="cb192-4"><a href="visualization.html#cb192-4"></a><span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Scatterplot with altered y-axis and larger symbols&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:scatter4"></span>
<img src="SCA_book_files/figure-html/scatter4-1.png" alt="A scatterplot with fitted regression line and larger symbols." width="75%" />
<p class="caption">
Figure 6.12: A scatterplot with fitted regression line and larger symbols.
</p>
</div>
<p>In Figure <a href="visualization.html#fig:scatter4">6.12</a> the plotting symbol is set to 19 (a solid circle) and expanded by a factor of 2. Both x and y axes have been rescaled. The labels on the axes have been left blank and default to the name of the variable (which is taken from the data set).</p>
</div>
<div id="an-example-with-multiple-symbols" class="section level3">
<h3><span class="header-section-number">6.6.3</span> An example with multiple symbols</h3>
<p>You have a data set called <code>blood.txt</code> which includes the variables <code>Subject</code>, <code>Gender</code>, <code>AgeGroup</code>, <code>RBC</code> (red blood cells), <code>WBC</code> (white blood cells) and <code>Chol</code> (Cholesterol). This data set has already been provided. Figure <a href="visualization.html#fig:scatternew">6.13</a> shows a better-looking example with multiple symbols</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="visualization.html#cb193-1"></a><span class="co"># Read the dataset</span></span>
<span id="cb193-2"><a href="visualization.html#cb193-2"></a>blood &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/blood.txt&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>, <span class="dt">na.strings =</span> <span class="st">&quot;.&quot;</span>, </span>
<span id="cb193-3"><a href="visualization.html#cb193-3"></a>                    <span class="dt">colClasses =</span> <span class="kw">c</span>(<span class="st">&quot;character&quot;</span>, <span class="st">&quot;character&quot;</span>, </span>
<span id="cb193-4"><a href="visualization.html#cb193-4"></a>                                   <span class="st">&quot;character&quot;</span>, <span class="st">&quot;character&quot;</span>,</span>
<span id="cb193-5"><a href="visualization.html#cb193-5"></a>                                 <span class="st">&quot;double&quot;</span>, <span class="st">&quot;double&quot;</span>, <span class="st">&quot;double&quot;</span>),)</span>
<span id="cb193-6"><a href="visualization.html#cb193-6"></a></span>
<span id="cb193-7"><a href="visualization.html#cb193-7"></a><span class="co"># Assign the names to the above dataset</span></span>
<span id="cb193-8"><a href="visualization.html#cb193-8"></a><span class="kw">names</span>(blood) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Subject&quot;</span>, <span class="st">&quot;Gender&quot;</span>, <span class="st">&quot;BloodType&quot;</span>, <span class="st">&quot;AgeGroup&quot;</span>, </span>
<span id="cb193-9"><a href="visualization.html#cb193-9"></a>               <span class="st">&quot;WBC&quot;</span>, <span class="st">&quot;RBC&quot;</span>, <span class="st">&quot;Chol&quot;</span>)</span>
<span id="cb193-10"><a href="visualization.html#cb193-10"></a></span>
<span id="cb193-11"><a href="visualization.html#cb193-11"></a><span class="co"># Draw a scatterplot</span></span>
<span id="cb193-12"><a href="visualization.html#cb193-12"></a><span class="kw">plot</span>(blood<span class="op">$</span>WBC, blood<span class="op">$</span>RBC, <span class="dt">xlab =</span> <span class="st">&quot;WBC&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;RBC&quot;</span>, </span>
<span id="cb193-13"><a href="visualization.html#cb193-13"></a>     <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">pch =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">9</span>))</span>
<span id="cb193-14"><a href="visualization.html#cb193-14"></a></span>
<span id="cb193-15"><a href="visualization.html#cb193-15"></a><span class="co"># Provide a legend</span></span>
<span id="cb193-16"><a href="visualization.html#cb193-16"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;AB&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;O&quot;</span>), <span class="dt">pch =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span></code></pre></div>
<div class="figure"><span id="fig:scatternew"></span>
<img src="SCA_book_files/figure-html/scatternew-1.png" alt="A scatterplot with multiple symbols and legend." width="672" />
<p class="caption">
Figure 6.13: A scatterplot with multiple symbols and legend.
</p>
</div>
<p><strong>Note:</strong> This function <code>legend()</code> can be used to add legends to plots. Look at help for details.</p>
</div>
</div>
<div id="line-plots-and-time-series-plots" class="section level2">
<h2><span class="header-section-number">6.7</span> Line plots and Time series plots</h2>
<p>Previously we learned about bar charts (including histograms), pie charts, boxplots and scatter plots. However, there may be occasions when we wish to display data as a line, perhaps to show a time series. There is no specific line plot command in R so we must use other graph types and coerce the program to produce our line.</p>
<div id="plot-types" class="section level3">
<h3><span class="header-section-number">6.7.1</span> Plot types</h3>
<p>If we produce a plot we generally get a series of points. The default symbol for the points is an open circle but we can alter it using the pch=n parameter (see the section on scatter plots). Actually the points are only one sort of plot type that we can achieve in R (the default). We can use the parameter type = “type” to create other plots.
Command Plot type</p>
<pre><code>type = &quot;p&quot;	Produces points.
type = &quot;l&quot;	Produces line segments.
type = &quot;b&quot;	Produces points joined by line segments.
type = &quot;o&quot;	Similar to &quot;b&quot; but the points are overlaid onto the line.
type = &quot;n&quot;	Produces a graph with nothing it it! This can be used to create a graph frame that you add lines to later.</code></pre>
<p>So for example we may type: <code>plot(x, y, type = "b")</code> to produce a simple line plot with added points.</p>
</div>
<div id="time-series" class="section level3">
<h3><span class="header-section-number">6.7.2</span> Time Series</h3>
<p>Consider the following data vostok, where we have mean monthly temperatures for an Antarctic research station.</p>
<pre><code> 	month	temp
1	Jan	-32.0
2	Feb	-47.3
3	Mar	-57.2
4	Apr	-62.9
5	May	-61.0
6	Jun	-70.6
7	Jul	-65.5
8	Aug	-68.2
9	Sep	-63.2
10	Oct	-58.0
11	Nov	-42.0
12	Dec	-30.4</code></pre>
<p>The file was read in using the standard <code>read.table()</code> command</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="visualization.html#cb196-1"></a>vostok =<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/vostok.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>so it contains two columns; month is a factor and temp is a numeric variable. If we attempt to plot the whole variable e.g. <code>plot(temp ~ month)</code> we get a horrid mess (try it and see). This is because the month is a factor and cannot be represented on an x, y scatter plot.</p>
<p>However, if we plot the temperature alone we get the beginnings of something sensible:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="visualization.html#cb197-1"></a><span class="kw">plot</span>(vostok<span class="op">$</span>temp)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:temp"></span>
<img src="SCA_book_files/figure-html/temp-1.png" alt="A plot the temperature alone." width="75%" />
<p class="caption">
Figure 6.14: A plot the temperature alone.
</p>
</div>
<p>Figure <a href="visualization.html#fig:temp">6.14</a> appears to be a series of points and they are in the correct order. We can easily join the dots to make a line plot by adding (<code>type="b"</code>) to the plot command (see the section on plot types). Notice how R have used default labels for the axes, temp for the y-axis is taken from the values in the variable but index is used for the x-axis because we have no reference (we only plotted a single variable).</p>
<p>What we need to do next is to alter the x-axis to reflect our month variable.</p>
<p><strong>Custom axes</strong></p>
<p>When we look at the time series plot produced above we see that the x-axis needs a bit of work. Since the plot was made from a single variable (<code>temp</code>) there are no values for <code>x</code> and R substitutes a numeric index.</p>
<p>We need to scrap the current axes and start again with our own. It is simple to produce a plot with no axes, merely add (<code>axes=F</code>) to the plot command; see <a href="visualization.html#fig:temp2">6.15</a> below.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="visualization.html#cb198-1"></a><span class="kw">plot</span>(vostok<span class="op">$</span>temp, <span class="dt">axes =</span> F)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:temp2"></span>
<img src="SCA_book_files/figure-html/temp2-1.png" alt="A plot the temperature without of axes." width="75%" />
<p class="caption">
Figure 6.15: A plot the temperature without of axes.
</p>
</div>
<p>However, R appends default labels to the axes so we need to get rid of those too:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="visualization.html#cb199-1"></a><span class="kw">plot</span>(vostok<span class="op">$</span>temp, <span class="dt">axes =</span> F, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:temp3"></span>
<img src="SCA_book_files/figure-html/temp3-1.png" alt="A plot the temperature without of axes or labels." width="75%" />
<p class="caption">
Figure 6.16: A plot the temperature without of axes or labels.
</p>
</div>
<p>That does the job; see Figure <a href="visualization.html#fig:temp3">6.16</a>. We are going to add axis labels of course so could have specified them now but I use the "" double (double) quotes to illustrate how to produce blank ones (setting xlab= F produces a label FALSE so we have to use "").</p>
<p>To add an axis we use the <code>axis()</code> command. Axis 1 is the bottom of the plot (i.e. the x-axis), axis 2 is the left side of the plot (the y-axis). We can also specify the top (3) and the right side (4) if we wish. In it’s simplest form <code>axis(n)</code> adds in the axis specified with it’s default parameters. This won’t do here because the default x-axis contains only index information. We need to tell R where to find the labels associated with the axis.</p>
<p>To generate an axis we need to specify the length of it and the labels to be used. Figure <a href="visualization.html#fig:temp4">6.17</a> is what we need for our temperature example:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="visualization.html#cb200-1"></a><span class="kw">plot</span>(vostok<span class="op">$</span>temp, <span class="dt">axes =</span> F, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb200-2"><a href="visualization.html#cb200-2"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(vostok<span class="op">$</span>temp), <span class="dt">labels =</span> vostok<span class="op">$</span>month)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:temp4"></span>
<img src="SCA_book_files/figure-html/temp4-1.png" alt="A plot of temperature. with time x-axis." width="75%" />
<p class="caption">
Figure 6.17: A plot of temperature. with time x-axis.
</p>
</div>
<p>Now we need to add in the y-axis and the axis labels. We could also add a title and perhaps the whole thing would look better if the dots were joined up to make a lineplot (which was after all the point of the exercise). Here is the whole series of commands from start to finish. Figure <a href="visualization.html#fig:temp5">6.18</a> shows the final time series plot.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="visualization.html#cb201-1"></a><span class="kw">plot</span>(vostok<span class="op">$</span>temp, <span class="dt">axes =</span> F, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb201-2"><a href="visualization.html#cb201-2"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(vostok<span class="op">$</span>temp), <span class="dt">labels =</span> vostok<span class="op">$</span>month)</span>
<span id="cb201-3"><a href="visualization.html#cb201-3"></a><span class="kw">axis</span>(<span class="dv">2</span>)</span>
<span id="cb201-4"><a href="visualization.html#cb201-4"></a><span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Time Series&quot;</span>, <span class="dt">font.main =</span> <span class="dv">4</span>, <span class="dt">xlab =</span> <span class="st">&quot;Month&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Mean Temp C&quot;</span>)</span>
<span id="cb201-5"><a href="visualization.html#cb201-5"></a><span class="kw">box</span>() <span class="co">#adds a border around the plot</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:temp5"></span>
<img src="SCA_book_files/figure-html/temp5-1.png" alt="A time series plot of temperature." width="75%" />
<p class="caption">
Figure 6.18: A time series plot of temperature.
</p>
</div>
</div>
</div>
<div id="visualization-using-ggplot2" class="section level2">
<h2><span class="header-section-number">6.8</span> Visualization using <code>ggplot2</code></h2>
<p>The package we will use to create visualizations is <code>ggplot2</code>. It allows for more sophisticated visualization as one progresses. <code>ggplot2</code> allows for visualization using layers and addition of different commands that are useful in continuing to build and modify a visual representation.</p>
<p>The typical syntax for creating a visualization specifies the dataset to be used, aesthetics of mapping that specifies the variable, and the type of chart such as barchart or a scatterplot etc to be used.</p>
<div id="scatter-plots" class="section level3">
<h3><span class="header-section-number">6.8.1</span> Scatter plots</h3>
<p>Simple scatterplots can be created using the R code below. The color, the size and the shape of points can be changed using the function <code>geom_point()</code> as follows:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="visualization.html#cb202-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb202-2"><a href="visualization.html#cb202-2"></a><span class="co"># Read the data</span></span>
<span id="cb202-3"><a href="visualization.html#cb202-3"></a>blood &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/blood.txt&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>, <span class="dt">na.strings =</span> <span class="st">&quot;.&quot;</span>, </span>
<span id="cb202-4"><a href="visualization.html#cb202-4"></a>                    <span class="dt">colClasses =</span> <span class="kw">c</span>(<span class="st">&quot;character&quot;</span>,<span class="st">&quot;character&quot;</span>,</span>
<span id="cb202-5"><a href="visualization.html#cb202-5"></a>                                   <span class="st">&quot;character&quot;</span>,<span class="st">&quot;character&quot;</span>,</span>
<span id="cb202-6"><a href="visualization.html#cb202-6"></a>                                   <span class="st">&quot;double&quot;</span>,<span class="st">&quot;double&quot;</span>,<span class="st">&quot;double&quot;</span>),)</span>
<span id="cb202-7"><a href="visualization.html#cb202-7"></a><span class="co"># Assign the names to the above dataset</span></span>
<span id="cb202-8"><a href="visualization.html#cb202-8"></a><span class="kw">names</span>(blood) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Subject&quot;</span>, <span class="st">&quot;Gender&quot;</span>, <span class="st">&quot;BloodType&quot;</span>, <span class="st">&quot;AgeGroup&quot;</span>, </span>
<span id="cb202-9"><a href="visualization.html#cb202-9"></a>               <span class="st">&quot;WBC&quot;</span>, <span class="st">&quot;RBC&quot;</span>, <span class="st">&quot;Chol&quot;</span>)</span>
<span id="cb202-10"><a href="visualization.html#cb202-10"></a>blood<span class="op">$</span>BloodType &lt;-<span class="st"> </span><span class="kw">as.factor</span>(blood<span class="op">$</span>BloodType)</span>
<span id="cb202-11"><a href="visualization.html#cb202-11"></a><span class="co"># Change point shapes by the levels of cyl</span></span>
<span id="cb202-12"><a href="visualization.html#cb202-12"></a><span class="kw">ggplot</span>(blood, <span class="kw">aes</span>(<span class="dt">x =</span> WBC, <span class="dt">y =</span> RBC, <span class="dt">shape =</span> BloodType)) <span class="op">+</span></span>
<span id="cb202-13"><a href="visualization.html#cb202-13"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 167 rows containing missing values
## (geom_point).</code></pre>
<div class="figure" style="text-align: center"><span id="fig:blood2-1"></span>
<img src="SCA_book_files/figure-html/blood2-1.png" alt="A scatterplot based on ggplot2." width="672" />
<p class="caption">
Figure 6.19: A scatterplot based on ggplot2.
</p>
</div>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="visualization.html#cb204-1"></a><span class="co"># Change point shapes and colors</span></span>
<span id="cb204-2"><a href="visualization.html#cb204-2"></a><span class="kw">ggplot</span>(blood, <span class="kw">aes</span>(<span class="dt">x =</span> WBC, <span class="dt">y =</span> RBC, <span class="dt">shape =</span> BloodType, </span>
<span id="cb204-3"><a href="visualization.html#cb204-3"></a>                  <span class="dt">color =</span> BloodType)) <span class="op">+</span></span>
<span id="cb204-4"><a href="visualization.html#cb204-4"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 167 rows containing missing values
## (geom_point).</code></pre>
<div class="figure" style="text-align: center"><span id="fig:blood2-2"></span>
<img src="SCA_book_files/figure-html/blood2-2.png" alt="A scatterplot based on ggplot2." width="672" />
<p class="caption">
Figure 6.20: A scatterplot based on ggplot2.
</p>
</div>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="visualization.html#cb206-1"></a><span class="co"># Change point shapes, colors and size</span></span>
<span id="cb206-2"><a href="visualization.html#cb206-2"></a><span class="kw">ggplot</span>(blood, <span class="kw">aes</span>(<span class="dt">x =</span> WBC, <span class="dt">y =</span> RBC, <span class="dt">shape =</span> BloodType, </span>
<span id="cb206-3"><a href="visualization.html#cb206-3"></a>                  <span class="dt">color =</span> BloodType, <span class="dt">size =</span> Chol)) <span class="op">+</span></span>
<span id="cb206-4"><a href="visualization.html#cb206-4"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 337 rows containing missing values
## (geom_point).</code></pre>
<div class="figure" style="text-align: center"><span id="fig:blood2-3"></span>
<img src="SCA_book_files/figure-html/blood2-3.png" alt="A scatterplot based on ggplot2." width="672" />
<p class="caption">
Figure 6.21: A scatterplot based on ggplot2.
</p>
</div>
</div>
<div id="creating-maps-with-ggplot2" class="section level3">
<h3><span class="header-section-number">6.8.2</span> Creating maps with <code>ggplot2</code></h3>
<p>We will learn how to make choropleth maps, sometimes called heat maps, using the <code>ggplot2</code> package. A <strong>choropleth map</strong> is a map that shows a geographic landscape with units such as countries, states, or watersheds where each unit is colored according to a particular value.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="visualization.html#cb208-1"></a><span class="co"># Read map and data</span></span>
<span id="cb208-2"><a href="visualization.html#cb208-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb208-3"><a href="visualization.html#cb208-3"></a><span class="kw">library</span>(maps)</span>
<span id="cb208-4"><a href="visualization.html#cb208-4"></a><span class="co"># load United States state map data</span></span>
<span id="cb208-5"><a href="visualization.html#cb208-5"></a>MainStates &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;state&quot;</span>)</span>
<span id="cb208-6"><a href="visualization.html#cb208-6"></a><span class="co"># read the state population data</span></span>
<span id="cb208-7"><a href="visualization.html#cb208-7"></a>StatePopulation &lt;-<span class="st"> </span></span>
<span id="cb208-8"><a href="visualization.html#cb208-8"></a><span class="st">  </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/ds4stats/r-tutorials/master/intro-maps/data/StatePopulation.csv&quot;</span>, <span class="dt">as.is =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Your first map</li>
</ol>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="visualization.html#cb209-1"></a><span class="kw">qplot</span>(long, lat, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">data =</span> MainStates)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-126"></span>
<img src="SCA_book_files/figure-html/unnamed-chunk-126-1.png" alt="Your first map." width="75%" />
<p class="caption">
Figure 6.22: Your first map.
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Making a base map</li>
</ol>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="visualization.html#cb210-1"></a><span class="co">#plot all states with ggplot2, using black borders and light blue fill</span></span>
<span id="cb210-2"><a href="visualization.html#cb210-2"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb210-3"><a href="visualization.html#cb210-3"></a><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> MainStates, </span>
<span id="cb210-4"><a href="visualization.html#cb210-4"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group),</span>
<span id="cb210-5"><a href="visualization.html#cb210-5"></a>                <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-127"></span>
<img src="SCA_book_files/figure-html/unnamed-chunk-127-1.png" alt="A base map." width="75%" />
<p class="caption">
Figure 6.23: A base map.
</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Customizing your choropleth map</li>
</ol>
<p>Now that we have created a base map of the mainland states, we will color each state according to its population. The first step is to use the <code>dplyr</code> package to merge the <code>MainStates</code> and <code>StatePopulation</code> files.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="visualization.html#cb211-1"></a><span class="co"># Use the dplyr package to merge MainStates and StatePopulation</span></span>
<span id="cb211-2"><a href="visualization.html#cb211-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb211-3"><a href="visualization.html#cb211-3"></a>MergedStates &lt;-<span class="st"> </span><span class="kw">inner_join</span>(MainStates, StatePopulation, </span>
<span id="cb211-4"><a href="visualization.html#cb211-4"></a>                           <span class="dt">by =</span> <span class="st">&quot;region&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="visualization.html#cb212-1"></a><span class="co"># Create a Choropleth map of the United States</span></span>
<span id="cb212-2"><a href="visualization.html#cb212-2"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>()</span>
<span id="cb212-3"><a href="visualization.html#cb212-3"></a>p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> MergedStates, </span>
<span id="cb212-4"><a href="visualization.html#cb212-4"></a>          <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group, </span>
<span id="cb212-5"><a href="visualization.html#cb212-5"></a>              <span class="dt">fill =</span> population<span class="op">/</span><span class="dv">1000000</span>), </span>
<span id="cb212-6"><a href="visualization.html#cb212-6"></a>          <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="fl">0.2</span>) </span>
<span id="cb212-7"><a href="visualization.html#cb212-7"></a>p</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-129"></span>
<img src="SCA_book_files/figure-html/unnamed-chunk-129-1.png" alt="A customized choropleth map." width="75%" />
<p class="caption">
Figure 6.24: A customized choropleth map.
</p>
</div>
<p><strong>Remarks</strong></p>
<ul>
<li><p>Instead of using <code>population</code>, we use <code>population/1000000</code>. Each state is colored by <code>population size (in millions)</code> to make the legend easier to read.</p></li>
<li><p>Border color (<code>white</code>) and line thickness (<code>0.2</code>) are specifically defined within this <code>geom</code>.</p></li>
</ul>
<p>Once a map is created, it is often helpful to modify color schemes, determine how to address missing values (<code>na.values</code>) and formalize labels. Notice that we assigned the graph a name, <code>p</code>. This is particularly useful as we add new components to the graph.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="visualization.html#cb213-1"></a>p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Population(millions)&quot;</span>, </span>
<span id="cb213-2"><a href="visualization.html#cb213-2"></a>            <span class="dt">low =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">40</span>), </span>
<span id="cb213-3"><a href="visualization.html#cb213-3"></a>            <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">35</span>), <span class="dt">na.value =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></span>
<span id="cb213-4"><a href="visualization.html#cb213-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;State Population in the Mainland United States&quot;</span>)</span>
<span id="cb213-5"><a href="visualization.html#cb213-5"></a>p</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-130"></span>
<img src="SCA_book_files/figure-html/unnamed-chunk-130-1.png" alt="A customized choropleth map filled in with green coloor." width="672" />
<p class="caption">
Figure 6.25: A customized choropleth map filled in with green coloor.
</p>
</div>
<p>It is also possible to overlay two polygon maps. The code below creates county borders with a small line size and then adds a thicker line to represent state borders. The <code>alpha = .3</code> causes the fill in the state map to be transparent, allowing us to see the county map behind the state map.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="visualization.html#cb214-1"></a>AllCounty &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;county&quot;</span>)</span>
<span id="cb214-2"><a href="visualization.html#cb214-2"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_polygon</span>(<span class="dt">data=</span>AllCounty, </span>
<span id="cb214-3"><a href="visualization.html#cb214-3"></a>                        <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </span>
<span id="cb214-4"><a href="visualization.html#cb214-4"></a>                        <span class="dt">color =</span> <span class="st">&quot;darkblue&quot;</span>, </span>
<span id="cb214-5"><a href="visualization.html#cb214-5"></a>                        <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, </span>
<span id="cb214-6"><a href="visualization.html#cb214-6"></a>                        <span class="dt">size =</span> <span class="fl">.1</span> ) <span class="op">+</span></span>
<span id="cb214-7"><a href="visualization.html#cb214-7"></a><span class="st">  </span></span>
<span id="cb214-8"><a href="visualization.html#cb214-8"></a><span class="st">          </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> MainStates, </span>
<span id="cb214-9"><a href="visualization.html#cb214-9"></a>                       <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </span>
<span id="cb214-10"><a href="visualization.html#cb214-10"></a>                       <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb214-11"><a href="visualization.html#cb214-11"></a>                       <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">.3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-131"></span>
<img src="SCA_book_files/figure-html/unnamed-chunk-131-1.png" alt="A county map." width="480" />
<p class="caption">
Figure 6.26: A county map.
</p>
</div>
</div>
</div>
<div id="exercises" class="section level2">
<h2><span class="header-section-number">6.9</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Plot the <code>sine(x)</code> and <code>cos(x)</code> curves on the same plot, where <span class="math inline">\(x\in[-\pi,\pi]\)</span>. For the sine curve use a line and for the cosine curve use points.</p></li>
<li><p>Read in the data from the file <code>ozone.txt</code>. It contains 78 measurements of ozone concentration in the downtown Los Angeles atmosphere during the summers of 1966 and 1967.</p>
<ol style="list-style-type: lower-alpha">
<li>Find the minimum and maximum of ozone data;</li>
<li>Draw a histogram for the data;</li>
<li>Draw a boxplot for the data;</li>
<li>Draw a stem-and-leaf chart for the data.</li>
</ol></li>
<li><p>A medical researcher wishes to determine if a pill has the undesirable side effect of reducing the blood pressure of the user. The study involves recording the initial blood pressures of 15 college-age women. After they use the pill regularly for six months, their blood pressures are again recorded. The researcher wishes to draw inferences about the effect of the pill on blood pressure from the observations given in the following:</p></li>
</ol>
<pre><code>               Blood-pressure Measurements Before and After Use of Pill
               --------------------------------------------------------
               Subject     1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
               --------------------------------------------------------
               Before(x)  70 80 72 76 76 76 72 78 82 64 74 92 74 68 84
               After(y)   68 72 62 70 58 66 68 52 64 72 74 60 74 72 74
               --------------------------------------------------------</code></pre>
<p>Draw a scatter plot. Make the x-axis represent the “Before” measurements, and y-axis represent “After” measurements.</p>
<ol start="4" style="list-style-type: decimal">
<li>Do the following for the <code>data(mpg)</code>.
<ol style="list-style-type: lower-alpha">
<li>Run <code>ggplot(data = mpg)</code>. What do you see?</li>
<li>How many rows are in <code>mpg</code>? How many columns?</li>
<li>What does the <code>drv</code> variable describe? Read the help for <code>?mpg</code> to find out.</li>
<li>Make a scatterplot of <code>hwy</code> vs <code>cyl</code>.</li>
<li>What happens if you make a scatterplot of <code>class</code> vs <code>drv</code>? Why is the plot not useful?</li>
</ol></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exportimport-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-markdown.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SCA_book.pdf", "SCA_book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
